<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"/>
<title>Worldwide Intel Board</title>

<meta http-equiv="Content-Security-Policy" content="
  default-src 'self';
  script-src 'self' https://cdn.jsdelivr.net;
  style-src 'self';
  img-src 'self' data: https:;
  connect-src 'self' https://intel.aristocles24.workers.dev https://*.workers.dev https://dascient.github.io;
  font-src 'self' data:;
  frame-src https://www.youtube.com;
  base-uri 'self';
  form-action 'none';
  object-src 'none';
  upgrade-insecure-requests;
">

<link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'%3E%3Ccircle cx='16' cy='16' r='16' fill='%230b0f14'/%3E%3Cpath d='M8 18h16v2H8zM10 12h12v2H10z' fill='%235ec6ff'/%3E%3C/svg%3E" />

<link rel="stylesheet" href="./styles.css" />

<!-- Chart.js (only external script) -->
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js" defer></script>

<!-- Your app JS -->
<script src="./app.js" defer></script>
</head>
<body class="p-6">
<header class="mb-6 flex flex-wrap items-end justify-between gap-4">
  <div>
    <h1 class="text-2xl font-semibold tracking-tight">üåê Worldwide Intel Board</h1>
    <p class="text-sm text-[var(--muted)]">Global feeds + GenAI enrichment + clustering</p>
  </div>
  <div class="flex flex-wrap items-center gap-3">
    <label class="text-sm text-[var(--muted)]">Since (hrs)
      <input id="sinceHours" class="ghost w-24" type="number" min="2" max="72" value="12">
    </label>
    <label class="text-sm text-[var(--muted)]">Limit
      <input id="limit" class="ghost w-24" type="number" min="6" max="60" value="18">
    </label>
    <label class="text-sm text-[var(--muted)]">Topic
      <select id="topicFilter" class="ghost w-48"><option value="all">All</option></select>
    </label>
    <label class="text-sm text-[var(--muted)]">Source
      <select id="sourceFilter" class="ghost w-48"><option value="all">All</option></select>
    </label>
    <button id="refreshBtn" class="ghost hover:bg-[#0c1219]">Refresh</button>
  </div>
</header>

<main class="grid grid-cols-1 xl:grid-cols-3 gap-6">
  <section class="space-y-6 order-1 xl:order-none">
    <div class="card p-4">
      <div class="flex items-center justify-between mb-2">
        <h2 class="font-semibold">Regions</h2><small class="text-[var(--muted)]">last window</small>
      </div>
      <div class="h-56"><canvas id="regionChart"></canvas></div>
    </div>
    <div class="card p-4">
      <div class="flex items-center justify-between mb-2">
        <h2 class="font-semibold">Top Topics</h2><small class="text-[var(--muted)]">enriched</small>
      </div>
      <div class="h-60"><canvas id="topicChart"></canvas></div>
    </div>
    <div class="card p-4">
      <div class="flex items-center justify-between mb-2">
        <h2 class="font-semibold">Live</h2><small class="text-[var(--muted)]">licensed sources</small>
      </div>
      <div class="space-y-2 text-sm">
        <a class="link block" href="https://www.youtube.com/aljazeeraenglish/live" target="_blank" rel="noopener">Al Jazeera English</a>
        <a class="link block" href="https://www.youtube.com/dwnews/live" target="_blank" rel="noopener">DW News</a>
        <a class="link block" href="https://www.youtube.com/france24_en/live" target="_blank" rel="noopener">France 24</a>
      </div>
    </div>
    <div class="card p-4">
      <div class="flex items-center justify-between mb-2">
        <h2 class="font-semibold">Ticker</h2><small class="text-[var(--muted)]">/api/stream</small>
      </div>
      <div id="ticker" class="ticker text-sm text-[var(--muted)]"><span>connecting‚Ä¶</span></div>
    </div>
  </section>

  <section class="xl:col-span-2 space-y-6">
    <div class="card p-4">
      <div class="flex items-center justify-between mb-4">
        <h2 class="font-semibold">Enriched Feed</h2>
        <small id="windowInfo" class="text-[var(--muted)]"></small>
      </div>
      <div id="feedsGrid" class="grid gap-4 md:grid-cols-2 2xl:grid-cols-3"></div>
    </div>
    <div class="card p-4">
      <div class="flex items-center justify-between mb-4">
        <h2 class="font-semibold">Clusters</h2>
        <small class="text-[var(--muted)]">corroborated stories</small>
      </div>
      <div id="clustersGrid" class="grid gap-4 sm:grid-cols-2"></div>
    </div>
  </section>
</main>

<!-- Your app JS (external file to satisfy CSP) -->
<script src="./app.js" defer></script>
</body>
</html>
