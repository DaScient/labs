<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Crypto Nebula VR - Digital Currency Dashboard</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="apple-mobile-web-app-capable" content="yes">
  
  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Exo+2:wght@300;400;600;700&display=swap" rel="stylesheet">
  
  <!-- Core Libraries -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/echarts/5.4.3/echarts.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/typed.js/2.0.12/typed.min.js"></script>
  
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    html, body {
      height: 100%;
      overflow: hidden;
      font-family: 'Exo 2', sans-serif;
      background: radial-gradient(ellipse at center, #2a0f3a 0%, #000000 70%);
      color: #e0f7ff;
      perspective: 1000px;
      transform-style: preserve-3d;
    }
    
    /* === AUTO-HIDE SYSTEM === */
    .auto-hide {
      transition: opacity 0.5s ease, transform 0.5s ease;
      opacity: 1;
    }
    
    .auto-hide.hidden {
      opacity: 0 !important;
      pointer-events: none !important;
      transform: translateZ(0) !important;
    }
    
    /* Reveal indicator */
    .reveal-hint {
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%) translateZ(500px);
      background: rgba(20, 10, 40, 0.8);
      border: 1px solid rgba(255, 0, 255, 0.5);
      border-radius: 20px;
      padding: 8px 16px;
      font-size: 11px;
      color: #ff00ff;
      font-family: 'Orbitron', monospace;
      opacity: 0;
      transition: opacity 0.3s ease;
      pointer-events: none;
      z-index: 1000;
    }
    
    .reveal-hint.visible {
      opacity: 0.7;
    }
    
    /* Typography */
    .cosmic-title {
      font-family: 'Orbitron', monospace;
      font-weight: 900;
      background: linear-gradient(45deg, #ff00ff, #00ffff, #ffff00);
      background-size: 400% 400%;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      animation: cosmicGradient 3s ease-in-out infinite;
      text-shadow: 0 0 30px rgba(255, 0, 255, 0.5);
    }
    
    @keyframes cosmicGradient {
      0%, 100% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
    }
    
    /* Layout */
    .dashboard-container {
      display: grid;
      grid-template-columns: 1fr 2fr 1fr;
      grid-template-rows: 80px 1fr 120px;
      height: 100vh;
      gap: 20px;
      padding: 20px;
    }
    
    .header {
      grid-column: 1 / -1;
      display: flex;
      align-items: center;
      justify-content: space-between;
      background: rgba(20, 10, 40, 0.3);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 0, 255, 0.2);
      border-radius: 15px;
      padding: 20px 30px;
      transform: translateZ(100px);
    }
    
    .main-chart {
      background: rgba(20, 10, 40, 0.2);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 0, 255, 0.2);
      border-radius: 15px;
      padding: 20px;
      position: relative;
      transform: translateZ(50px);
    }
    
    .sidebar {
      background: rgba(20, 10, 40, 0.2);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 0, 255, 0.2);
      border-radius: 15px;
      padding: 20px;
      overflow-y: auto;
      transform: translateZ(80px);
    }
    
    .bottom-panel {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 20px;
    }
    
    .crypto-card {
      background: rgba(20, 10, 40, 0.3);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 0, 255, 0.2);
      border-radius: 15px;
      padding: 20px;
      text-align: center;
      transition: all 0.3s ease;
      cursor: pointer;
      position: relative;
      overflow: hidden;
      transform: translateZ(30px);
    }
    
    .crypto-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 0, 255, 0.1), transparent);
      transition: left 0.5s ease;
    }
    
    .crypto-card:hover::before {
      left: 100%;
    }
    
    .crypto-card:hover {
      background: rgba(40, 20, 80, 0.4);
      border-color: rgba(255, 0, 255, 0.4);
      transform: translateY(-8px) translateZ(40px) scale(1.03);
      box-shadow: 0 20px 50px rgba(255, 0, 255, 0.3);
    }
    
    /* Navigation */
    .nav-menu {
      display: flex;
      gap: 30px;
    }
    
    .nav-item {
      color: #e0f7ff;
      text-decoration: none;
      font-family: 'Orbitron', monospace;
      font-weight: 600;
      font-size: 14px;
      padding: 10px 20px;
      border-radius: 20px;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
      transform: translateZ(10px);
    }
    
    .nav-item:hover {
      color: #ff00ff;
      text-shadow: 0 0 20px rgba(255, 0, 255, 0.8);
      background: rgba(255, 0, 255, 0.1);
      transform: translateY(-2px) translateZ(15px);
    }
    
    /* Crypto List */
    .crypto-item {
      display: flex;
      align-items: center;
      padding: 15px;
      margin-bottom: 10px;
      background: rgba(40, 20, 60, 0.3);
      border-radius: 10px;
      transition: all 0.3s ease;
      cursor: pointer;
      position: relative;
      transform: translateZ(20px);
    }
    
    .crypto-item:hover {
      background: rgba(255, 0, 255, 0.1);
      transform: translateX(10px) translateZ(25px) scale(1.02);
      box-shadow: 0 10px 30px rgba(255, 0, 255, 0.2);
    }
    
    .crypto-icon {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: linear-gradient(45deg, #ff00ff, #00ffff);
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      color: #000;
      margin-right: 15px;
      font-size: 16px;
      transform: translateZ(5px);
      transition: all 0.3s ease;
    }
    
    .crypto-item:hover .crypto-icon {
      transform: rotate(360deg) scale(1.1) translateZ(10px);
    }
    
    .crypto-info {
      flex: 1;
    }
    
    .crypto-symbol {
      font-family: 'Orbitron', monospace;
      font-weight: 700;
      color: #ff00ff;
      font-size: 16px;
      transform: translateZ(5px);
    }
    
    .crypto-name {
      font-size: 12px;
      color: #a0f0ff;
      margin-top: 2px;
    }
    
    .crypto-price {
      font-weight: 600;
      color: #ffffff;
      font-size: 16px;
      transform: translateZ(5px);
    }
    
    .crypto-change {
      font-size: 12px;
      font-weight: 600;
      margin-top: 2px;
      transform: translateZ(5px);
    }
    
    .crypto-change.positive {
      color: #00ff88;
    }
    
    .crypto-change.negative {
      color: #ff3366;
    }
    
    /* Market Data */
    .market-data {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 15px;
      margin-bottom: 20px;
    }
    
    .data-item {
      text-align: center;
      padding: 15px;
      background: rgba(40, 20, 60, 0.2);
      border-radius: 10px;
      transition: all 0.3s ease;
      cursor: pointer;
      transform: translateZ(15px);
    }
    
    .data-item:hover {
      background: rgba(80, 40, 120, 0.3);
      transform: scale(1.05) translateZ(20px);
    }
    
    .data-label {
      font-size: 12px;
      color: #e0f7ff;
      margin-bottom: 5px;
    }
    
    .data-value {
      font-family: 'Orbitron', monospace;
      font-weight: 700;
      font-size: 18px;
      color: #ff00ff;
    }
    
    /* Chart Container */
    .chart-container {
      width: 100%;
      height: 400px;
      margin-bottom: 20px;
    }
    
    /* Canvas Background */
    #cosmicCanvas {
      position: absolute;
      top: 0;
      left: 0;
      z-index: -1;
      opacity: 0.3;
    }
    
    /* Status Indicators */
    .status-bar {
      display: flex;
      align-items: center;
      gap: 20px;
    }
    
    .status-item {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 12px;
      color: #e0f7ff;
      transform: translateZ(10px);
    }
    
    .status-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      animation: pulse 2s infinite;
    }
    
    .status-dot.online { background: #ff00ff; }
    .status-dot.processing { background: #00ffff; }
    .status-dot.warning { background: #ffff00; }
    
    @keyframes pulse {
      0%, 100% { opacity: 0.8; transform: scale(1); }
      50% { opacity: 1; transform: scale(1.1); }
    }
    
    /* VR Controls */
    .vr-controls {
      position: absolute;
      top: 50%;
      left: 30px;
      transform: translateY(-50%) translateZ(150px);
      z-index: 20;
      pointer-events: all;
    }
    
    .vr-toggle {
      background: rgba(255, 0, 255, 0.2);
      border: 2px solid rgba(255, 0, 255, 0.5);
      border-radius: 15px;
      padding: 10px 15px;
      color: #ff00ff;
      font-family: 'Orbitron', monospace;
      font-size: 12px;
      cursor: pointer;
      transition: all 0.3s ease;
      margin-bottom: 10px;
      transform: translateZ(20px);
    }
    
    .vr-toggle:hover {
      background: rgba(255, 0, 255, 0.3);
      transform: translateY(-2px) translateZ(25px);
    }
    
    .vr-status {
      font-size: 10px;
      color: #e0f7ff;
      text-align: center;
      transform: translateZ(15px);
    }
    
    /* Gyroscope Info */
    .gyro-info {
      position: absolute;
      top: 50%;
      right: 30px;
      transform: translateY(-50%) translateZ(180px);
      background: rgba(20, 10, 40, 0.8);
      border: 1px solid rgba(255, 0, 255, 0.3);
      border-radius: 15px;
      padding: 20px;
      max-width: 200px;
      z-index: 15;
      pointer-events: none;
    }
    
    .gyro-info h4 {
      color: #ff00ff;
      font-family: 'Orbitron', monospace;
      margin-bottom: 10px;
    }
    
    .gyro-info p {
      font-size: 11px;
      color: #e0f7ff;
      line-height: 1.4;
      margin-bottom: 8px;
    }
    
    .gyro-status {
      padding: 5px 10px;
      border-radius: 10px;
      font-size: 10px;
      font-weight: 600;
      text-align: center;
      margin-top: 10px;
    }
    
    .gyro-status.enabled {
      background: rgba(0, 255, 0, 0.2);
      color: #00ff00;
      border: 1px solid rgba(0, 255, 0, 0.3);
    }
    
    .gyro-status.disabled {
      background: rgba(255, 0, 0, 0.2);
      color: #ff0000;
      border: 1px solid rgba(255, 0, 0, 0.3);
    }
    
    /* VR Mode Styles */
    .vr-mode {
      perspective: 2000px;
    }
    
    .vr-mode .dashboard-container {
      transform: translateZ(100px);
    }
    
    .vr-mode .header {
      transform: translateZ(200px);
    }
    
    .vr-mode .main-chart {
      transform: translateZ(150px);
    }
    
    .vr-mode .sidebar {
      transform: translateZ(180px);
    }
    
    .vr-mode .crypto-card {
      transform: translateZ(120px);
    }
    
    /* 3D Chart Enhancements */
    .chart-3d-container {
      position: relative;
      width: 100%;
      height: 400px;
      transform-style: preserve-3d;
    }
    
    .chart-3d-container::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(45deg, transparent 49%, rgba(255, 0, 255, 0.1) 50%, transparent 51%);
      background-size: 20px 20px;
      pointer-events: none;
      z-index: 1;
    }
    
    /* Responsive Design */
    @media (max-width: 1200px) {
      .dashboard-container {
        grid-template-columns: 1fr;
        grid-template-rows: 80px auto auto auto;
      }
      
      .bottom-panel {
        grid-template-columns: repeat(2, 1fr);
      }
    }
    
    @media (max-width: 768px) {
      .bottom-panel {
        grid-template-columns: 1fr;
      }
      
      .header {
        flex-direction: column;
        gap: 15px;
        text-align: center;
      }
      
      .nav-menu {
        gap: 15px;
      }
      
      .vr-controls {
        left: 20px;
      }
      
      .gyro-info {
        right: 20px;
        max-width: 180px;
      }
    }
    
    /* Animation Classes */
    .fade-in {
      animation: fadeIn 1s ease-in-out;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px) translateZ(-50px); }
      to { opacity: 1; transform: translateY(0) translateZ(0); }
    }
    
    .slide-in-left {
      animation: slideInLeft 0.8s ease-out;
    }
    
    @keyframes slideInLeft {
      from { opacity: 0; transform: translateX(-50px) translateZ(-50px); }
      to { opacity: 1; transform: translateX(0) translateZ(0); }
    }
    
    .slide-in-right {
      animation: slideInRight 0.8s ease-out;
    }
    
    @keyframes slideInRight {
      from { opacity: 0; transform: translateX(50px) translateZ(-50px); }
      to { opacity: 1; transform: translateX(0) translateZ(0); }
    }
    
    .rotate-in {
      animation: rotateIn 1s ease-out;
    }
    
    @keyframes rotateIn {
      from { opacity: 0; transform: rotateY(-90deg) translateZ(-100px); }
      to { opacity: 1; transform: rotateY(0deg) translateZ(0); }
    }
    
    /* VR Chart Enhancements */
    .echarts-canvas {
      transform: translateZ(10px);
    }
    
    /* Gyroscope Calibration */
    .gyro-calibration {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%) translateZ(300px);
      background: rgba(20, 10, 40, 0.9);
      border: 2px solid rgba(255, 0, 255, 0.5);
      border-radius: 20px;
      padding: 30px;
      text-align: center;
      z-index: 100;
      display: none;
    }
    
    .gyro-calibration.active {
      display: block;
    }
    
    .calibration-title {
      color: #ff00ff;
      font-family: 'Orbitron', monospace;
      font-size: 18px;
      margin-bottom: 15px;
    }
    
    .calibration-instructions {
      color: #e0f7ff;
      font-size: 14px;
      line-height: 1.5;
      margin-bottom: 20px;
    }
    
    .calibration-button {
      background: linear-gradient(45deg, #ff00ff, #00ffff);
      border: none;
      border-radius: 25px;
      padding: 12px 30px;
      color: #000;
      font-family: 'Orbitron', monospace;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    
    .calibration-button:hover {
      transform: scale(1.05);
      box-shadow: 0 10px 30px rgba(255, 0, 255, 0.5);
    }
    
    /* Crypto-specific VR effects */
    .crypto-glow {
      animation: cryptoGlow 2s ease-in-out infinite alternate;
    }
    
    @keyframes cryptoGlow {
      from { box-shadow: 0 0 20px rgba(255, 0, 255, 0.3); }
      to { box-shadow: 0 0 40px rgba(255, 0, 255, 0.6); }
    }
    
    .blockchain-particles {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 2;
    }
  </style>
</head>
<body>
  <!-- Background Canvas -->
  <canvas id="cosmicCanvas"></canvas>
  
  <!-- Blockchain Particles -->
  <div class="blockchain-particles" id="blockchainParticles"></div>
  
  <!-- Gyroscope Calibration (auto-hide exempt) -->
  <div class="gyro-calibration" id="gyroCalibration">
    <h3 class="calibration-title">üíé CRYPTO NEBULA VR</h3>
    <p class="calibration-instructions">
      Tilt and rotate to explore the crypto cosmos in 3D.<br>
      Point at different cryptocurrencies to see live data.<br>
      Use device motion to navigate through blockchain space.
    </p>
    <button class="calibration-button" onclick="startVRExperience()">
      ACTIVATE CRYPTO VR
    </button>
  </div>
  
  <!-- Reveal Hint (auto-hide exempt) -->
  <div class="reveal-hint" id="revealHint">Move mouse or touch screen to show controls</div>
  
  <!-- Dashboard Container -->
  <div class="dashboard-container">
    <!-- Header (auto-hide) -->
    <header class="header auto-hide" id="header">
      <div>
        <h1 class="cosmic-title">CRYPTO NEBULA VR</h1>
        <p style="color: #e0f7ff; font-size: 14px;">360¬∞ Digital Currency Cosmos</p>
      </div>
      
      <nav class="nav-menu">
        <a href="index.html" class="nav-item">üåå Cosmic Hub</a>
        <a href="stocks.html" class="nav-item">‚≠ê Stellar Markets</a>
        <a href="crypto.html" class="nav-item">üíé Crypto Nebula</a>
        <a href="ai-tools.html" class="nav-item">ü§ñ AI Matrix</a>
      </nav>
      
      <div class="status-bar">
        <div class="status-item">
          <div class="status-dot online"></div>
          <span>BLOCKCHAIN SYNCED</span>
        </div>
        <div class="status-item">
          <div class="status-dot processing"></div>
          <span>MINING ACTIVE</span>
        </div>
        <div class="status-item">
          <div class="status-dot warning"></div>
          <span>VOLATILE</span>
        </div>
      </div>
    </header>
    
    <!-- VR Controls (auto-hide) -->
    <div class="vr-controls auto-hide" id="vrControls">
      <div class="vr-toggle" onclick="toggleVRExperience()">
        üíé CRYPTO VR
      </div>
      <div class="vr-status" id="vrStatus">
        Click to enable VR
      </div>
    </div>
    
    <!-- Gyroscope Info (auto-hide) -->
    <div class="gyro-info auto-hide" id="gyroInfo">
      <h4>üîÆ VR Controls</h4>
      <p><strong>Tilt:</strong> Navigate crypto space</p>
      <p><strong>Rotate:</strong> 360¬∞ coin view</p>
      <p><strong>Point:</strong> Focus on prices</p>
      <p><strong>Touch:</strong> Select cryptos</p>
      <div class="gyro-status disabled" id="gyroStatus">
        GYROSCOPE OFF
      </div>
    </div>
    
    <!-- Main Chart (NOT auto-hide) -->
    <main class="main-chart fade-in">
      <h3 style="color: #ff00ff; margin-bottom: 20px; font-family: 'Orbitron', monospace;">
        Crypto Constellation 3D
      </h3>
      <div class="chart-3d-container" id="chart3dContainer">
        <div class="chart-container" id="mainChart"></div>
      </div>
    </main>
    
    <!-- Sidebar (auto-hide) -->
    <aside class="sidebar slide-in-right auto-hide" id="sidebar">
      <h3 style="color: #ff00ff; margin-bottom: 20px; font-family: 'Orbitron', monospace;">
        Digital Assets
      </h3>
      
      <!-- Market Data -->
      <div class="market-data">
        <div class="data-item">
          <div class="data-label">Market Cap</div>
          <div class="data-value" id="marketCap">$2.8T</div>
        </div>
        <div class="data-item">
          <div class="data-label">24h Volume</div>
          <div class="data-value" id="volume">$89B</div>
        </div>
        <div class="data-item">
          <div class="data-label">Active Wallets</div>
          <div class="data-value" id="wallets">420M</div>
        </div>
        <div class="data-item">
          <div class="data-label">Fear & Greed</div>
          <div class="data-value" id="fearGreed">72</div>
        </div>
      </div>
      
      <!-- Crypto List -->
      <div id="cryptoList">
        <!-- Cryptos will be populated by JavaScript -->
      </div>
    </aside>
    
    <!-- Bottom Panel (auto-hide) -->
    <section class="bottom-panel auto-hide" id="bottomPanel">
      <div class="crypto-card slide-in-left crypto-glow">
        <h4 style="color: #ff00ff; margin-bottom: 10px;">BITCOIN</h4>
        <div style="font-size: 24px; font-weight: bold; margin-bottom: 5px;" id="btcPrice">$67,234.56</div>
        <div style="font-size: 14px; color: #00ff88;" id="btcChange">+2.34%</div>
      </div>
      
      <div class="crypto-card slide-in-left">
        <h4 style="color: #ff00ff; margin-bottom: 10px;">ETHEREUM</h4>
        <div style="font-size: 24px; font-weight: bold; margin-bottom: 5px;" id="ethPrice">$3,456.78</div>
        <div style="font-size: 14px; color: #ff3366;" id="ethChange">-1.23%</div>
      </div>
      
      <div class="crypto-card slide-in-right crypto-glow">
        <h4 style="color: #ff00ff; margin-bottom: 10px;">SOLANA</h4>
        <div style="font-size: 24px; font-weight: bold; margin-bottom: 5px;" id="solPrice">$178.90</div>
        <div style="font-size: 14px; color: #00ff88;" id="solChange">+5.67%</div>
      </div>
      
      <div class="crypto-card slide-in-right">
        <h4 style="color: #ff00ff; margin-bottom: 10px;">CARDANO</h4>
        <div style="font-size: 24px; font-weight: bold; margin-bottom: 5px;" id="adaPrice">$0.612</div>
        <div style="font-size: 14px; color: #ff3366;" id="adaChange">-0.89%</div>
      </div>
    </section>
  </div>
  
  <script>
    // Sample crypto data
    const cryptoData = [
      { symbol: 'BTC', name: 'Bitcoin', price: 67234.56, change: 2.34, percent: 2.34, icon: '‚Çø' },
      { symbol: 'ETH', name: 'Ethereum', price: 3456.78, change: -1.23, percent: -1.23, icon: 'Œû' },
      { symbol: 'SOL', name: 'Solana', price: 178.90, change: 5.67, percent: 5.67, icon: '‚óé' },
      { symbol: 'ADA', name: 'Cardano', price: 0.612, change: -0.89, percent: -0.89, icon: '‚Ç≥' },
      { symbol: 'DOT', name: 'Polkadot', price: 8.45, change: 3.21, percent: 3.21, icon: '‚óè' },
      { symbol: 'AVAX', name: 'Avalanche', price: 45.67, change: -2.34, percent: -2.34, icon: '‚ñ≤' },
      { symbol: 'MATIC', name: 'Polygon', price: 1.23, change: 1.56, percent: 1.56, icon: '‚¨ü' },
      { symbol: 'LINK', name: 'Chainlink', price: 18.90, change: 4.32, percent: 4.32, icon: '‚¨¢' },
      { symbol: 'UNI', name: 'Uniswap', price: 12.34, change: -1.78, percent: -1.78, icon: '‚äö' },
      { symbol: 'AAVE', name: 'Aave', price: 234.56, change: 6.78, percent: 6.78, icon: '‚óØ' }
    ];
    
    // VR Variables
    let vrMode = false;
    let deviceOrientation = { alpha: 0, beta: 0, gamma: 0 };
    let myChart;
    let autoHideManager;
    
    // Initialize background canvas
    function initBackgroundCanvas() {
      const canvas = document.getElementById('cosmicCanvas');
      const ctx = canvas.getContext('2d');
      
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
      
      const particles = [];
      const particleCount = 150;
      
      // Create particles
      for (let i = 0; i < particleCount; i++) {
        particles.push({
          x: Math.random() * canvas.width,
          y: Math.random() * canvas.height,
          vx: (Math.random() - 0.5) * 0.8,
          vy: (Math.random() - 0.5) * 0.8,
          size: Math.random() * 3 + 1,
          opacity: Math.random() * 0.7 + 0.3,
          color: Math.random() > 0.5 ? '#ff00ff' : '#00ffff',
          pulse: Math.random() * Math.PI * 2
        });
      }
      
      function animate() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        
        particles.forEach(particle => {
          particle.x += particle.vx;
          particle.y += particle.vy;
          particle.pulse += 0.05;
          
          if (particle.x < 0 || particle.x > canvas.width) particle.vx *= -1;
          if (particle.y < 0 || particle.y > canvas.height) particle.vy *= -1;
          
          const pulseSize = particle.size + Math.sin(particle.pulse) * 1;
          ctx.beginPath();
          ctx.arc(particle.x, particle.y, pulseSize, 0, Math.PI * 2);
          ctx.fillStyle = particle.color + Math.floor(particle.opacity * 255).toString(16).padStart(2, '0');
          ctx.fill();
          
          // Add glow effect for VR
          ctx.shadowBlur = 15;
          ctx.shadowColor = particle.color;
          ctx.fill();
          ctx.shadowBlur = 0;
        });
        
        requestAnimationFrame(animate);
      }
      
      animate();
    }
    
    // Initialize blockchain particles
    function initBlockchainParticles() {
      const container = document.getElementById('blockchainParticles');
      
      for (let i = 0; i < 20; i++) {
        const particle = document.createElement('div');
        particle.style.position = 'absolute';
        particle.style.width = '4px';
        particle.style.height = '4px';
        particle.style.background = Math.random() > 0.5 ? '#ff00ff' : '#00ffff';
        particle.style.borderRadius = '50%';
        particle.style.left = Math.random() * 100 + '%';
        particle.style.top = Math.random() * 100 + '%';
        particle.style.opacity = Math.random() * 0.5 + 0.3;
        particle.style.animation = `float ${2 + Math.random() * 3}s ease-in-out infinite`;
        particle.style.animationDelay = Math.random() * 2 + 's';
        
        container.appendChild(particle);
      }
    }
    
    // Initialize crypto list
    function initCryptoList() {
      const cryptoList = document.getElementById('cryptoList');
      
      cryptoData.forEach(crypto => {
        const cryptoItem = document.createElement('div');
        cryptoItem.className = 'crypto-item';
        
        const changeClass = crypto.change >= 0 ? 'positive' : 'negative';
        const changeSymbol = crypto.change >= 0 ? '+' : '';
        
        cryptoItem.innerHTML = `
          <div class="crypto-icon">${crypto.icon}</div>
          <div class="crypto-info">
            <div class="crypto-symbol">${crypto.symbol}</div>
            <div class="crypto-name">${crypto.name}</div>
          </div>
          <div style="text-align: right;">
            <div class="crypto-price">$${crypto.price.toLocaleString()}</div>
            <div class="crypto-change ${changeClass}">
              ${changeSymbol}${crypto.change.toFixed(2)} (${changeSymbol}${crypto.percent.toFixed(2)}%)
            </div>
          </div>
        `;
        
        cryptoItem.addEventListener('click', () => {
          updateMainChart(crypto);
          if (vrMode) {
            animateCrypto3D(crypto);
          }
          autoHideManager.resetTimer();
        });
        
        cryptoList.appendChild(cryptoItem);
      });
    }
    
    // Initialize main chart
    function initMainChart() {
      const chartDom = document.getElementById('mainChart');
      myChart = echarts.init(chartDom);
      
      // Generate sample data for the last 24 hours
      const hours = [];
      const values = [];
      const baseValue = 67234;
      
      for (let i = 23; i >= 0; i--) {
        const hour = new Date();
        hour.setHours(hour.getHours() - i);
        hours.push(hour.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit' }));
        
        const randomChange = (Math.random() - 0.5) * 2000;
        const trend = Math.sin((23 - i) * 0.3) * 500;
        const value = baseValue + trend + randomChange;
        values.push(value.toFixed(0));
      }
      
      const option = {
        backgroundColor: 'transparent',
        title: {
          text: 'Crypto Constellation 3D',
          textStyle: {
            color: '#ff00ff',
            fontSize: 16,
            fontFamily: 'Orbitron'
          }
        },
        tooltip: {
          trigger: 'axis',
          backgroundColor: 'rgba(20, 10, 40, 0.9)',
          borderColor: '#ff00ff',
          textStyle: {
            color: '#e0f7ff'
          }
        },
        xAxis: {
          type: 'category',
          data: hours,
          axisLine: {
            lineStyle: {
              color: '#ff00ff'
            }
          },
          axisLabel: {
            color: '#e0f7ff',
            fontSize: 10
          }
        },
        yAxis: {
          type: 'value',
          axisLine: {
            lineStyle: {
              color: '#ff00ff'
            }
          },
          axisLabel: {
            color: '#e0f7ff',
            fontSize: 10,
            formatter: '${value}'
          },
          splitLine: {
            lineStyle: {
              color: 'rgba(255, 0, 255, 0.1)'
            }
          }
        },
        series: [{
          data: values,
          type: 'line',
          smooth: true,
          lineStyle: {
            color: '#ff00ff',
            width: 3
          },
          areaStyle: {
            color: {
              type: 'linear',
              x: 0,
              y: 0,
              x2: 0,
              y2: 1,
              colorStops: [{
                offset: 0,
                color: 'rgba(255, 0, 255, 0.3)'
              }, {
                offset: 1,
                color: 'rgba(255, 0, 255, 0.05)'
              }]
            }
          },
          symbol: 'circle',
          symbolSize: 8,
          itemStyle: {
            color: '#ff00ff',
            borderColor: '#ffffff',
            borderWidth: 2
          }
        }]
      };
      
      myChart.setOption(option);
      
      // Make chart responsive
      window.addEventListener('resize', () => {
        myChart.resize();
      });
    }
    
    // Update main chart with specific crypto
    function updateMainChart(crypto) {
      const chartDom = document.getElementById('mainChart');
      
      // Generate data for the selected crypto
      const hours = [];
      const values = [];
      const baseValue = crypto.price;
      
      for (let i = 23; i >= 0; i--) {
        const hour = new Date();
        hour.setHours(hour.getHours() - i);
        hours.push(hour.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit' }));
        
        const randomChange = (Math.random() - 0.5) * (baseValue * 0.05);
        const trend = Math.sin((23 - i) * 0.3) * (baseValue * 0.02);
        const value = baseValue + trend + randomChange;
        values.push(value.toFixed(2));
      }
      
      myChart.setOption({
        title: {
          text: `${crypto.symbol} - ${crypto.name}`
        },
        xAxis: {
          data: hours
        },
        series: [{
          data: values
        }]
      });
    }
    
    // Animate crypto in 3D for VR
    function animateCrypto3D(crypto) {
      const chartContainer = document.getElementById('chart3dContainer');
      
      // Change chart color based on crypto
      const color = crypto.change >= 0 ? '#00ff88' : '#ff3366';
      
      anime({
        targets: chartContainer,
        rotateX: [0, 15, 0],
        rotateY: [0, 20, 0],
        rotateZ: [0, 10, 0],
        duration: 2500,
        easing: 'easeInOutQuad',
        complete: () => {
          // Update chart with crypto color
          myChart.setOption({
            title: {
              textStyle: {
                color: color
              }
            },
            xAxis: {
              axisLine: {
                lineStyle: {
                  color: color
                }
              }
            },
            yAxis: {
              axisLine: {
                lineStyle: {
                  color: color
                }
              }
            },
            series: [{
              lineStyle: {
                color: color
              },
              areaStyle: {
                color: {
                  colorStops: [{
                    offset: 0,
                    color: color + '4D'
                  }, {
                    offset: 1,
                    color: color + '0D'
                  }]
                }
              }
            }]
          });
          
          anime({
            targets: chartContainer,
            rotateX: 0,
            rotateY: 0,
            rotateZ: 0,
            duration: 1000,
            easing: 'easeOutQuad'
          });
        }
      });
    }
    
    // Simulate real-time data updates
    function simulateRealTimeData() {
      setInterval(() => {
        // Update random crypto prices
        cryptoData.forEach(crypto => {
          const change = (Math.random() - 0.5) * (crypto.price * 0.02);
          crypto.price += change;
          crypto.change = change;
          crypto.percent = (change / crypto.price) * 100;
        });
        
        // Update main crypto cards
        const cryptos = ['btc', 'eth', 'sol', 'ada'];
        cryptos.forEach((crypto, index) => {
          const priceElement = document.getElementById(`${crypto}Price`);
          const changeElement = document.getElementById(`${crypto}Change`);
          
          if (priceElement && changeElement) {
            const data = cryptoData[index];
            priceElement.textContent = `$${data.price.toLocaleString()}`;
            
            const changeClass = data.change >= 0 ? 'positive' : 'negative';
            const changeSymbol = data.change >= 0 ? '+' : '';
            changeElement.textContent = `${changeSymbol}${data.percent.toFixed(2)}%`;
            changeElement.className = `crypto-change ${changeClass}`;
            
            // Add glow effect for positive changes
            if (data.change >= 0) {
              priceElement.parentElement.parentElement.classList.add('crypto-glow');
            } else {
              priceElement.parentElement.parentElement.classList.remove('crypto-glow');
            }
          }
        });
        
        // Update market data
        const marketCap = document.getElementById('marketCap');
        const volume = document.getElementById('volume');
        const wallets = document.getElementById('wallets');
        const fearGreed = document.getElementById('fearGreed');
        
        // Simulate changing market data
        const currentCap = parseFloat(marketCap.textContent.replace(/[^0-9.]/g, ''));
        marketCap.textContent = `$${(currentCap + Math.random() * 0.1 - 0.05).toFixed(1)}T`;
        
        const currentVolume = parseFloat(volume.textContent.replace(/[^0-9.]/g, ''));
        volume.textContent = `$${(currentVolume + Math.random() * 2 - 1).toFixed(0)}B`;
        
        const currentWallets = parseFloat(wallets.textContent.replace(/[^0-9.]/g, ''));
        wallets.textContent = `${(currentWallets + Math.random() * 5 - 2.5).toFixed(0)}M`;
        
        const currentFearGreed = parseInt(fearGreed.textContent);
        fearGreed.textContent = `${Math.max(0, Math.min(100, currentFearGreed + Math.random() * 10 - 5)).toFixed(0)}`;
        
      }, 2000);
    }
    
    // VR Controls
    function toggleVRExperience() {
      vrMode = !vrMode;
      const body = document.body;
      const vrStatus = document.getElementById('vrStatus');
      
      if (vrMode) {
        body.classList.add('vr-mode');
        vrStatus.textContent = 'VR ENABLED';
        vrStatus.style.color = '#ff00ff';
        
        // Initialize gyroscope
        if (window.DeviceOrientationEvent) {
          if (typeof DeviceOrientationEvent.requestPermission === 'function') {
            document.getElementById('gyroCalibration').classList.add('active');
          } else {
            enableGyroscope();
          }
        }
        
        // Add blockchain particle effects
        initBlockchainParticles();
        
      } else {
        body.classList.remove('vr-mode');
        vrStatus.textContent = 'VR DISABLED';
        vrStatus.style.color = '#e0f7ff';
        
        // Remove blockchain particles
        document.getElementById('blockchainParticles').innerHTML = '';
      }
      autoHideManager.resetTimer();
    }
    
    function startVRExperience() {
      if (typeof DeviceOrientationEvent.requestPermission === 'function') {
        DeviceOrientationEvent.requestPermission()
          .then(response => {
            if (response == 'granted') {
              enableGyroscope();
              document.getElementById('gyroCalibration').classList.remove('active');
            }
          })
          .catch(console.error);
      } else {
        enableGyroscope();
        document.getElementById('gyroCalibration').classList.remove('active');
      }
      autoHideManager.resetTimer();
    }
    
    function enableGyroscope() {
      window.addEventListener('deviceorientation', handleOrientation, true);
      window.addEventListener('devicemotion', handleMotion, true);
      
      document.getElementById('gyroStatus').textContent = 'GYROSCOPE ACTIVE';
      document.getElementById('gyroStatus').className = 'gyro-status enabled';
      
      // Update status bar
      document.querySelector('.status-item span').textContent = '360¬∞ TRACKING';
    }
    
    function handleOrientation(event) {
      if (!vrMode) return;
      
      deviceOrientation.alpha = event.alpha || 0;
      deviceOrientation.beta = event.beta || 0;
      deviceOrientation.gamma = event.gamma || 0;
      
      // Apply VR transformations to dashboard elements
      const rotationY = (deviceOrientation.alpha * Math.PI / 180) * 0.1;
      const rotationX = (deviceOrientation.beta * Math.PI / 180) * 0.05;
      
      // Rotate main chart based on device orientation
      const chartContainer = document.getElementById('chart3dContainer');
      chartContainer.style.transform = `rotateY(${rotationY}rad) rotateX(${rotationX}rad) translateZ(50px)`;
      
      // Update crypto cards with staggered rotation
      const cryptoCards = document.querySelectorAll('.crypto-card');
      cryptoCards.forEach((card, index) => {
        const delay = index * 0.1;
        card.style.transform = `rotateY(${rotationY * (index + 1) * 0.1}rad) translateZ(${30 + index * 10}px)`;
      });
      
      // Update crypto items
      const cryptoItems = document.querySelectorAll('.crypto-item');
      cryptoItems.forEach((item, index) => {
        item.style.transform = `translateX(${Math.sin(rotationY + index) * 5}px) translateZ(${20 + index * 2}px)`;
      });
      
      autoHideManager.resetTimer();
    }
    
    function handleMotion(event) {
      if (!vrMode || !event.acceleration) return;
      
      const acceleration = event.acceleration;
      
      // Add shake effects to data when device is moved
      if (Math.abs(acceleration.x) > 2 || Math.abs(acceleration.y) > 2 || Math.abs(acceleration.z) > 2) {
        // Animate market data updates
        const dataItems = document.querySelectorAll('.data-item');
        dataItems.forEach(item => {
          item.style.animation = 'pulse 0.5s ease-in-out';
          setTimeout(() => {
            item.style.animation = '';
          }, 500);
        });
        
        // Update blockchain particles
        const particles = document.querySelectorAll('#blockchainParticles div');
        particles.forEach(particle => {
          particle.style.left = Math.random() * 100 + '%';
          particle.style.top = Math.random() * 100 + '%';
        });
      }
      autoHideManager.resetTimer();
    }
    
    // Initialize application
    window.addEventListener('load', () => {
      initBackgroundCanvas();
      initBlockchainParticles();
      initCryptoList();
      initMainChart();
      simulateRealTimeData();
      
      // Initialize Auto-Hide Manager
      autoHideManager = new AutoHideManager();
      
      // Add entrance animations
      setTimeout(() => {
        document.querySelector('.main-chart').classList.add('fade-in');
      }, 300);
      
      setTimeout(() => {
        document.querySelector('.sidebar').classList.add('slide-in-right');
      }, 600);
      
      setTimeout(() => {
        document.querySelectorAll('.crypto-card').forEach((card, index) => {
          setTimeout(() => {
            card.style.opacity = '0';
            card.style.transform = 'translateY(50px) translateZ(-50px)';
            card.style.transition = 'all 0.6s ease-out';
            setTimeout(() => {
              card.style.opacity = '1';
              card.style.transform = 'translateY(0) translateZ(30px)';
            }, 100);
          }, index * 200);
        });
      }, 900);
    });
    
    // Handle window resize
    window.addEventListener('resize', () => {
      const canvas = document.getElementById('cosmicCanvas');
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
      
      if (myChart) {
        myChart.resize();
      }
    });
    
    // === AUTO-HIDE MANAGER CLASS ===
    class AutoHideManager {
      constructor() {
        this.hideDelay = 3000; // 3 seconds
        this.elements = document.querySelectorAll('.auto-hide');
        this.revealHint = document.getElementById('revealHint');
        this.init();
      }

      init() {
        this.resetTimer();
        this.setupEventListeners();
        this.showHintAfterDelay();
      }

      setupEventListeners() {
        const events = ['mousemove', 'click', 'touchstart', 'touchmove', 'keydown', 'deviceorientation', 'devicemotion'];
        events.forEach(event => {
          window.addEventListener(event, () => this.showAll(), { passive: true });
          window.addEventListener(event, () => this.resetTimer(), { passive: true });
        });
      }

      showAll() {
        this.elements.forEach(el => el.classList.remove('hidden'));
        this.hideRevealHint();
      }

      hideAll() {
        // Don't hide if calibration is active
        if (document.getElementById('gyroCalibration').classList.contains('active')) return;
        this.elements.forEach(el => el.classList.add('hidden'));
        this.showRevealHint();
      }

      resetTimer() {
        clearTimeout(autoHideTimer);
        autoHideTimer = setTimeout(() => this.hideAll(), this.hideDelay);
      }

      showRevealHint() {
        if (this.revealHint) {
          clearTimeout(revealHintTimer);
          this.revealHint.classList.add('visible');
        }
      }

      hideRevealHint() {
        if (this.revealHint) {
          clearTimeout(revealHintTimer);
          revealHintTimer = setTimeout(() => {
            this.revealHint.classList.remove('visible');
          }, 2000);
        }
      }

      showHintAfterDelay() {
        setTimeout(() => {
          if (this.elements[0].classList.contains('hidden')) {
            this.showRevealHint();
          }
        }, 5000);
      }
    }
  </script>
</body>
</html>
